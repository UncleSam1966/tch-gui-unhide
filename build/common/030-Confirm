if [ "$(uci get dropbear.lan.enable)" = "1" -a "$(uci get dropbear.lan.PasswordAuth)" = "on" -a "$(uci get dropbear.lan.RootPasswordAuth)" = "on" -a "$(uci get dropbear.lan.RootLogin)" = "1" ]; then
  FIX_SSH=n
else
  FIX_SSH=y
fi
if [ "$(uci get system.config.export_plaintext)" = "1" -a "$(uci get system.config.export_unsigned)" = "1" -a "$(uci get system.config.import_plaintext)" = "1" -a "$(uci get system.config.import_unsigned)" = "1" ]; then
  FIX_CFG_PORT=n
else
  FIX_CFG_PORT=y
fi
echo "$(uci get web.parentalblock.roles)" | grep -q "admin"
if [ $? -eq 0 ]
then
  FIX_PARENT_BLK=n
else
  FIX_PARENT_BLK=y
fi


echo "[$SCRIPT]: This script will perform the following actions:"
if [ $FIX_SSH = y ]; then
echo "[$SCRIPT]:  - Properly enable SSH access over LAN"
fi
if [ $FIX_CFG_PORT = y ]; then
echo "[$SCRIPT]:  - Enable unsigned configuration export/import in the web GUI"
fi
if [ $FIX_FW_UPG = y ]; then
echo "[$SCRIPT]:  - Enable firmware upgrade in the web GUI"
elif [ $FIX_FW_UPG = n ]; then
echo "[$SCRIPT]:  - DISABLE firmware upgrade in the web GUI"
fi
if [ $FIX_PARENT_BLK = y ]; then
echo "[$SCRIPT]:  - Ensure admin role can administer the parental block"
fi
echo "[$SCRIPT]:  - Allow editing of various settings that are not exposed in the stock GUI"
echo "[$SCRIPT]:  - Unhide various cards and tabs contained in the stock GUI that are normally hidden"
echo "[$SCRIPT]:  - Add new cards and screens, and modified cards and screens from the Ansuel tch-nginx-gui"
echo "[$SCRIPT]:  - The GUI screens will be prettied up a bit and the $THEME theme applied with $COLOR highlights and $ICONS card icons"
if [ -f /www/docroot/landingpage.lp ]; then
echo "[$SCRIPT]:  - The Telstra Landing Page will be $(echo $KEEP_LP | sed -e 's/y/left UNCHANGED/' -e 's/n/themed and de-branded/')"
fi
echo "[$SCRIPT]:  - The browser tabs titles will be set to $TITLE"

echo [$SCRIPT]: If you wish to proceed, enter y otherwise just press [Enter] to stop.
if [ $YES = y ]; then
  REPLY=y
else
  read
fi
if [ "$REPLY" != "y" -a "$REPLY" != "Y" ]; then
  exit
fi

echo [$SCRIPT]: IMPORTANT NOTE - You can restore changed GUI files to their original state by running: $0 -r

